; This is a pattern for the patch fixing CVE-2019-5436 on ARM platforms
; This should hit on: libcurl.so.4.5.0_3.0.0.4.384_47912_Global.zip.d16a2f7cc11c34ac246a9da227bde70967b1459ab7c77d8a0f3f97b73e4964a0

; There's at least one other non-vulnerable binary in our dataset:
;  libcurl.so.4.1.1_4.3.3.1051 build 20190921.zip.a28ae7b021919662fcfb00283a9422decbe0c3992abd76bda659a611582817d9
; This binary is not vulnerable by virtue of being too old
; This pattern doesn't (yet) hit this binary

; This pattern is plagued by the fact that we can't have ","s inside the "[]"s

;ldr `Q1/r./.*,/3`,[r3,#0x638]


`META`
{
    "compile_using": [
        {
            "path": "/testdata/libcurl.so.5.3.0_1.1.41__c.img.072e35e5ec2ce061001992644d83f267c3aea08c622311dd56b44f43b2663394",
            "compiled_at_address": "0x00044c6c",
            "md5": "d75d5fb5620991d9b1c66e690a3e1491"
        }
    ]
}
`META_END`

cmp `Q1/r.`,#0x0
`ANY_BYTES{0,4}`
mov `Q1`,#0x200
`ANY_BYTES{0,60}`
mvn `Q2/r.`,#0x63
mov `Q3/r.`,#0x0
;`ANY_BYTES{0,28}`
;str `Q2`,[r4,#0x8]
;str `Q1`,[r4,#0x140]


; Copyright (C) 2023 The MITRE Corporation All Rights Reserved
