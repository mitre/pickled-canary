; This is a pattern for CVE2-2019-5436 on ARM platforms

; See also the "thumb" version of this pattern.
; WARNING: Any changes made here should also be made in the "thumb" version of this pattern!

`META`
{
    "compile_using": [
        {
            "path": "/testdata/libcurl.so.5.3.0_1.1.41__c.img.072e35e5ec2ce061001992644d83f267c3aea08c622311dd56b44f43b2663394",
            "compiled_at_address": "0x00044c6c",
            "md5": "d75d5fb5620991d9b1c66e690a3e1491"
        }
    ]
}
`META_END`

`START_OR`
    mov `Q1/[lr].`,#0x0
    `ANY_BYTES{0,38}`
    mvn `Q2/[lr].`,#0x63
    `ANY_BYTES{0,16}`
    `START_OR`
        mov `Q3/[lr].`,#0x200
    `OR`
        ; This OR case is for: ..\..\..\Documents\paterns\libcurl\libcurl_versions\from_tool\testdata\libcurl.so.5.3.0_2.1.2__b.img.b73debbf9bcb1ab55e4dd75acd99d000727be6c95d72609873429a591dd70120
        ; Should be able to do the following rather than the line after... but...
        add `Q2`,`Q2`,#0x264
        ;add r3,r3,#0x264
    `END_OR`
`OR`
    mov `Q33/[lr].`,#0x200
    `ANY_BYTES{4,16}`
    `START_OR`
        mov `Q34/[lr]..?`,#0x0
    `OR`
        ; the following line should work... but results in fewer hits than the line after it
        ; sub `Q33`,`Q33`,#0x200
        sub r3,r3,#0x200
    `END_OR`
    `ANY_BYTES{0,16}`
    mvn `Q35/[lr].`,#0x63
`END_OR`

; Copyright (C) 2023 The MITRE Corporation All Rights Reserved
